{"version":3,"sources":["webpack:///./assets/js/theme/gift-certificate.js"],"names":["GiftCertificate","$certBalanceForm","$","purchaseModel","recipientName","val","length","recipientEmail","formModel","email","senderName","senderEmail","customAmount","value","min","max","setAmount","options","found","forEach","option","$purchaseForm","$customAmounts","find","purchaseValidator","nod","submit","delay","$element","data","minFormatted","maxFormatted","add","selector","validate","cb","numberVal","Number","errorMessage","result","triggeredBy","get","checked","balanceVal","checkCertBalanceValidator","performCheck","areAll","event","preventDefault","click","modal","defaultModal","previewUrl","currentTarget","serialize","open","api","getPage","err","content","updateContent","context","previewError","wrap","$balanceForm","balanceValidator","giftCertChecker","PageManager"],"mappings":"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","file":"theme-bundle.chunk.1.js","sourcesContent":["import PageManager from './page-manager';\nimport $ from 'jquery';\nimport nod from './common/nod';\nimport giftCertChecker from './common/gift-certificate-validator';\nimport formModel from './common/models/forms';\nimport { api } from '@bigcommerce/stencil-utils';\nimport { defaultModal } from './global/modal';\n\nexport default class GiftCertificate extends PageManager {\n    constructor() {\n        super();\n\n        const $certBalanceForm = $('#gift-certificate-balance');\n\n        const purchaseModel = {\n            recipientName(val) {\n                return val.length;\n            },\n            recipientEmail(...args) {\n                return formModel.email(...args);\n            },\n            senderName(val) {\n                return val.length;\n            },\n            senderEmail(...args) {\n                return formModel.email(...args);\n            },\n            customAmount(value, min, max) {\n                return value && value >= min && value <= max;\n            },\n            setAmount(value, options) {\n                let found = false;\n\n                options.forEach((option) => {\n                    if (option === value) {\n                        found = true;\n                        return false;\n                    }\n                });\n\n                return found;\n            },\n        };\n\n        const $purchaseForm = $('#gift-certificate-form');\n        const $customAmounts = $purchaseForm.find('input[name=\"certificate_amount\"]');\n        const purchaseValidator = nod({\n            submit: '#gift-certificate-form input[type=\"submit\"]',\n            delay: 300,\n        });\n\n        if ($customAmounts.length) {\n            const $element = $purchaseForm.find('input[name=\"certificate_amount\"]');\n            const min = $element.data('min');\n            const minFormatted = $element.data('min-formatted');\n            const max = $element.data('max');\n            const maxFormatted = $element.data('max-formatted');\n\n            purchaseValidator.add({\n                selector: '#gift-certificate-form input[name=\"certificate_amount\"]',\n                validate: (cb, val) => {\n                    const numberVal = Number(val);\n\n                    if (!numberVal) {\n                        cb(false);\n                    }\n\n                    cb(numberVal >= min && numberVal <= max);\n                },\n                errorMessage: `You must enter a certificate amount between ${minFormatted} and ${maxFormatted}.`,\n            });\n        }\n\n        purchaseValidator.add([\n            {\n                selector: '#gift-certificate-form input[name=\"to_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientName(val);\n\n                    cb(result);\n                },\n                errorMessage: 'You must enter a valid recipient name.',\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"to_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.recipientEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: 'You must enter a valid recipient email.',\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_name\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderName(val);\n\n                    cb(result);\n                },\n                errorMessage: 'You must enter your name.',\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"from_email\"]',\n                validate: (cb, val) => {\n                    const result = purchaseModel.senderEmail(val);\n\n                    cb(result);\n                },\n                errorMessage: 'You must enter a valid email.',\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"certificate_theme\"]:first-of-type',\n                triggeredBy: '#gift-certificate-form input[name=\"certificate_theme\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"certificate_theme\"]:checked').val();\n\n                    cb(typeof(val) === 'string');\n                },\n                errorMessage: 'You must select a gift certificate theme.',\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: 'You must agree to these terms.',\n            },\n            {\n                selector: '#gift-certificate-form input[name=\"agree2\"]',\n                validate: (cb) => {\n                    const val = $purchaseForm.find('input[name=\"agree2\"]').get(0).checked;\n\n                    cb(val);\n                },\n                errorMessage: 'You must agree to these terms.',\n            },\n        ]);\n\n        if ($certBalanceForm.length) {\n            const balanceVal = this.checkCertBalanceValidator($certBalanceForm);\n\n            $certBalanceForm.submit(() => {\n                balanceVal.performCheck();\n\n                if (!balanceVal.areAll('valid')) {\n                    return false;\n                }\n            });\n        }\n\n        $purchaseForm.submit((event) => {\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return event.preventDefault();\n            }\n        });\n\n        $('#gift-certificate-preview').click((event) => {\n            event.preventDefault();\n\n            purchaseValidator.performCheck();\n\n            if (!purchaseValidator.areAll('valid')) {\n                return;\n            }\n\n            const modal = defaultModal();\n            const previewUrl = `${$(event.currentTarget).data('preview-url')}&${$purchaseForm.serialize()}`;\n\n            modal.open();\n\n            api.getPage(previewUrl, {}, (err, content) => {\n                if (err) {\n                    return modal.updateContent(this.context.previewError);\n                }\n\n                modal.updateContent(content, { wrap: true });\n            });\n        });\n    }\n\n    checkCertBalanceValidator($balanceForm) {\n        const balanceValidator = nod({\n            submit: $balanceForm.find('input[type=\"submit\"]'),\n        });\n\n        balanceValidator.add({\n            selector: $balanceForm.find('input[name=\"giftcertificatecode\"]'),\n            validate(cb, val) {\n                cb(giftCertChecker(val));\n            },\n            errorMessage: 'You must enter a certificate code.',\n        });\n\n        return balanceValidator;\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./assets/js/theme/gift-certificate.js"],"sourceRoot":""}